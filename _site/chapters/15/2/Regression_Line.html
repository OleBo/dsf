<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>The Regression Line</title>
  <meta name="description" content="The Regression LineThe correlation coefficient $r$ doesn’t just measure how clustered the points in a scatter plot are about a straight line. It also helps i...">

  <link rel="canonical" href="https://olebo.github.io/dsf/chapters/15/2/Regression_Line.html">
  <link rel="alternate" type="application/rss+xml" title="" href="https://olebo.github.io/dsf/feed.xml">

  <meta property="og:url"         content="https://olebo.github.io/dsf/chapters/15/2/Regression_Line.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="The Regression Line" />
<meta property="og:description" content="The Regression LineThe correlation coefficient $r$ doesn’t just measure how clustered the points in a scatter plot are about a straight line. It also helps i..." />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "https://olebo.github.io/dsf/chapters/15/2/Regression_Line.html",
  "headline":
    "The Regression Line",
  "datePublished":
    "2019-02-10T19:20:55+01:00",
  "dateModified":
    "2019-02-10T19:20:55+01:00",
  "description":
    "The Regression LineThe correlation coefficient $r$ doesn’t just measure how clustered the points in a scatter plot are about a straight line. It also helps i...",
  "author": {
    "@type": "Person",
    "name": "Berkeley DSEP"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://olebo.github.io/dsf",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://olebo.github.io/dsf",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/dsf/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/dsf/favicon.png">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/dsf';
  </script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/dsf/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


  <!-- Google analytics -->
  <script src="/dsf/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/dsf/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('.input_area pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.querySelector(`pre#${id} + a`) == null) {
      codeCell.insertAdjacentHTML('afterend', clipboardButton(id));
    }
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>
  
  <!-- Hide cell code -->
  
<script>
/**
Add buttons to hide code cells
*/


var setCodeCellVisibility = function(inputField, kind) {
    // Update the image and class for hidden
    var id = inputField.getAttribute('data-id');
    var codeCell = document.querySelector(`#${id}`);

    if (kind === "visible") {
        codeCell.classList.remove('hidden');
        inputField.checked = true;
    } else {
        codeCell.classList.add('hidden');
        inputField.checked = false;
    }
}

var toggleCodeCellVisibility = function (event) {
    // The label is clicked, and now we decide what to do based on the input field's clicked status
    if (event.target.tagName === "LABEL") {
        var inputField = event.target.previousElementSibling;
    } else {
        // It is the span inside the target
        var inputField = event.target.parentElement.previousElementSibling;
    }

    if (inputField.checked === true) {
        setCodeCellVisibility(inputField, "visible");
    } else {
        setCodeCellVisibility(inputField, "hidden");
    }
}


// Button constructor
const hideCodeButton = id => `<input class="hidebtn" type="checkbox" id="hidebtn${id}" data-id="${id}"><label title="Toggle cell" for="hidebtn${id}" class="plusminus"><span class="pm_h"></span><span class="pm_v"></span></label>`

var addHideButton = function () {
  // If a hide button is already added, don't add another
  if (document.querySelector('div.hidecode input') !== null) {
      return;
  }

  // Find the input cells and add a hide button
  document.querySelectorAll('div.input_area div.highlight').forEach(function (item, index) {
    if (!item.parentElement.classList.contains("hidecode")) {
        // Skip the cell if it doesn't have a hidecode class
        return;
    }

    const id = codeCellId(index)
    item.setAttribute('id', id);
    item.insertAdjacentHTML('afterend', hideCodeButton(id))

    // Set up the visibility toggle
    hideLink = document.querySelector(`#${id} + input + label`);
    hideLink.addEventListener('click', toggleCodeCellVisibility)
  });
}


// Initialize the hide buttos
var initHiddenCells = function () {
    // Add hide buttons to the cells
    addHideButton();

    // Toggle the code cells that should be hidden
    document.querySelectorAll('div.hidecode input').forEach(function (item) {
        setCodeCellVisibility(item, 'hidden');
        item.checked = true;
    })
}

initFunction(initHiddenCells);

</script>


  <!-- Load custom website scripts -->
  <script src="/dsf/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/dsf/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/dsf/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("https://olebo.github.io") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>

</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <img src="/dsf/favicon.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/>
  <h2 class="c-sidebar__title"></h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/intro"
        >
          
          Introduction
        </a>

        
      </li>

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/01/what-is-data-science"
        >
          
            1.
          
          Data Science
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/01/1/intro"
                >
                  
                    1.1
                  
                  Introduction
                </a>

                
                
                  
                  
    
                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/dsf/chapters/01/1/1/computational-tools"
                    >
                      
                        1.1.1
                        
                      
                      Computational Tools
                    </a>
                
                  
                  
    
                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/dsf/chapters/01/1/2/statistical-techniques"
                    >
                      
                        1.1.2
                        
                      
                      Statistical Techniques
                    </a>
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/01/2/why-data-science"
                >
                  
                    1.2
                  
                  Why Data Science?
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/01/3/Plotting_the_Classics"
                >
                  
                    1.3
                  
                  Plotting the Classics
                </a>

                
                
                  
                  
    
                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/dsf/chapters/01/3/1/Literary_Characters"
                    >
                      
                        1.3.1
                        
                      
                      Literary Characters
                    </a>
                
                  
                  
    
                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/dsf/chapters/01/3/2/Another_Kind_Of_Character"
                    >
                      
                        1.3.2
                        
                      
                      Another Kind of Character
                    </a>
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/02/causality-and-experiments"
        >
          
            2.
          
          Causality and Experiments
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/02/1/observation-and-visualization-john-snow-and-the-broad-street-pump"
                >
                  
                    2.1
                  
                  John Snow and the Broad Street Pump
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/02/2/snow-s-grand-experiment"
                >
                  
                    2.2
                  
                  Snow’s “Grand Experiment”
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/02/3/establishing-causality"
                >
                  
                    2.3
                  
                  Establishing Causality
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/02/4/randomization"
                >
                  
                    2.4
                  
                  Randomization
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/02/5/endnote"
                >
                  
                    2.5
                  
                  Endnote
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/03/programming-in-python"
        >
          
            3.
          
          Programming in Python
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/03/1/Expressions"
                >
                  
                    3.1
                  
                  Expressions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/03/2/Names"
                >
                  
                    3.2
                  
                  Names
                </a>

                
                
                  
                  
    
                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/dsf/chapters/03/2/1/Growth"
                    >
                      
                        3.2.1
                        
                      
                      Example: Growth Rates
                    </a>
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/03/3/Calls"
                >
                  
                    3.3
                  
                  Call Expressions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/03/4/Introduction_to_Tables"
                >
                  
                    3.4
                  
                  Introduction to Tables
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/04/Data_Types"
        >
          
            4.
          
          Data Types
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/04/1/Numbers"
                >
                  
                    4.1
                  
                  Numbers
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/04/2/Strings"
                >
                  
                    4.2
                  
                  Strings
                </a>

                
                
                  
                  
    
                  <li class="c-sidebar__subsection">
                    <a class="c-sidebar__entry "
                      href="/dsf/chapters/04/2/1/String_Methods"
                    >
                      
                        4.2.1
                        
                      
                      String Methods
                    </a>
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/04/3/Comparison"
                >
                  
                    4.3
                  
                  Comparisons
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/05/Sequences"
        >
          
            5.
          
          Sequences
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/05/1/Arrays"
                >
                  
                    5.1
                  
                  Arrays
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/05/2/Ranges"
                >
                  
                    5.2
                  
                  Ranges
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/05/3/More_on_Arrays"
                >
                  
                    5.3
                  
                  More on Arrays
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/06/Tables"
        >
          
            6.
          
          Tables
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/06/1/Sorting_Rows"
                >
                  
                    6.1
                  
                  Sorting Rows
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/06/2/Selecting_Rows"
                >
                  
                    6.2
                  
                  Selecting Rows
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/06/3/Example_Trends_in_the_Population_of_the_United_States"
                >
                  
                    6.3
                  
                  Example: Population Trends
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/06/4/Example_Gender_Ratio_in_the_US_Population"
                >
                  
                    6.4
                  
                  Example: Trends in Gender
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/07/Visualization"
        >
          
            7.
          
          Visualization
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/07/1/Visualizing_Categorical_Distributions"
                >
                  
                    7.1
                  
                  Categorical Distributions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/07/2/Visualizing_Numerical_Distributions"
                >
                  
                    7.2
                  
                  Numerical Distributions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/07/3/Overlaid_Graphs"
                >
                  
                    7.3
                  
                  Overlaid Graphs
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/08/Functions_and_Tables"
        >
          
            8.
          
          Functions and Tables
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/08/1/Applying_a_Function_to_a_Column"
                >
                  
                    8.1
                  
                  Applying Functions to Columns
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/08/2/Classifying_by_One_Variable"
                >
                  
                    8.2
                  
                  Classifying by One Variable
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/08/3/Cross-Classifying_by_More_than_One_Variable"
                >
                  
                    8.3
                  
                  Cross-Classifying
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/08/4/Joining_Tables_by_Columns"
                >
                  
                    8.4
                  
                  Joining Tables by Columns
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/08/5/Bike_Sharing_in_the_Bay_Area"
                >
                  
                    8.5
                  
                  Bike Sharing in the Bay Area
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/09/Randomness"
        >
          
            9.
          
          Randomness
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/09/1/Conditional_Statements"
                >
                  
                    9.1
                  
                  Conditional Statements
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/09/2/Iteration"
                >
                  
                    9.2
                  
                  Iteration
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/09/3/Simulation"
                >
                  
                    9.3
                  
                  Simulation
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/09/4/Monty_Hall_Problem"
                >
                  
                    9.4
                  
                  The Monty Hall Problem
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/09/5/Finding_Probabilities"
                >
                  
                    9.5
                  
                  Finding Probabilities
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/10/Sampling_and_Empirical_Distributions"
        >
          
            10.
          
          Sampling and Empirical Distributions
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/10/1/Empirical_Distributions"
                >
                  
                    10.1
                  
                  Empirical Distributions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/10/2/Sampling_from_a_Population"
                >
                  
                    10.2
                  
                  Sampling from a Population
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/10/3/Empirical_Distribution_of_a_Statistic"
                >
                  
                    10.3
                  
                  Empirical Distibution of a Statistic
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/11/Testing_Hypotheses"
        >
          
            11.
          
          Testing Hypotheses
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/11/1/Assessing_Models"
                >
                  
                    11.1
                  
                  Assessing Models
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/11/2/Multiple_Categories"
                >
                  
                    11.2
                  
                  Multiple Categories
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/11/3/Decisions_and_Uncertainty"
                >
                  
                    11.3
                  
                  Decisions and Uncertainty
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/12/Comparing_Two_Samples"
        >
          
            12.
          
          Comparing Two Samples
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/12/1/AB_Testing"
                >
                  
                    12.1
                  
                  A/B Testing
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/12/2/Deflategate"
                >
                  
                    12.2
                  
                  Deflategate
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/12/3/Causality"
                >
                  
                    12.3
                  
                  Causality
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/13/Estimation"
        >
          
            13.
          
          Estimation
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/13/1/Percentiles"
                >
                  
                    13.1
                  
                  Percentiles
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/13/2/Bootstrap"
                >
                  
                    13.2
                  
                  The Bootstrap
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/13/3/Confidence_Intervals"
                >
                  
                    13.3
                  
                  Confidence Intervals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/13/4/Using_Confidence_Intervals"
                >
                  
                    13.4
                  
                  Using Confidence Intervals
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/14/Why_the_Mean_Matters"
        >
          
            14.
          
          Why the Mean Matters
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/14/1/Properties_of_the_Mean"
                >
                  
                    14.1
                  
                  Properties of the Mean
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/14/2/Variability"
                >
                  
                    14.2
                  
                  Variability
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/14/3/SD_and_the_Normal_Curve"
                >
                  
                    14.3
                  
                  The SD and the Normal Curve
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/14/4/Central_Limit_Theorem"
                >
                  
                    14.4
                  
                  The Central Limit Theorem
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/14/5/Variability_of_the_Sample_Mean"
                >
                  
                    14.5
                  
                  The Variability of the Sample Mean
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/14/6/Choosing_a_Sample_Size"
                >
                  
                    14.6
                  
                  Choosing a Sample Size
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/15/Prediction"
        >
          
            15.
          
          Prediction
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/15/1/Correlation"
                >
                  
                    15.1
                  
                  Correlation
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/dsf/chapters/15/2/Regression_Line"
                >
                  
                    15.2
                  
                  The Regression Line
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/15/3/Method_of_Least_Squares"
                >
                  
                    15.3
                  
                  The Method of Least Squares
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/15/4/Least_Squares_Regression"
                >
                  
                    15.4
                  
                  Least Squares Regression
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/15/5/Visual_Diagnostics"
                >
                  
                    15.5
                  
                  Visual Diagnostics
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/15/6/Numerical_Diagnostics"
                >
                  
                    15.6
                  
                  Numerical Diagnostics
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/16/Inference_for_Regression"
        >
          
            16.
          
          Inference for Regression
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/16/1/Regression_Model"
                >
                  
                    16.1
                  
                  A Regression Model
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/16/2/Inference_for_the_True_Slope"
                >
                  
                    16.2
                  
                  Inference for the True Slope
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/16/3/Prediction_Intervals"
                >
                  
                    16.3
                  
                  Prediction Intervals
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/17/Classification"
        >
          
            17.
          
          Classification
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/17/1/Nearest_Neighbors"
                >
                  
                    17.1
                  
                  Nearest Neighbors
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/17/2/Training_and_Testing"
                >
                  
                    17.2
                  
                  Training and Testing
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/17/3/Rows_of_Tables"
                >
                  
                    17.3
                  
                  Rows of Tables
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/17/4/Implementing_the_Classifier"
                >
                  
                    17.4
                  
                  Implementing the Classifier
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/17/5/Accuracy_of_the_Classifier"
                >
                  
                    17.5
                  
                  The Accuracy of the Classifier
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/17/6/Multiple_Regression"
                >
                  
                    17.6
                  
                  Multiple Regression
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/dsf/chapters/18/Updating_Predictions"
        >
          
            18.
          
          Updating Predictions
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/18/1/More_Likely_than_Not_Binary_Classifier"
                >
                  
                    18.1
                  
                  A "More Likely Than Not" Binary Classifier
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/dsf/chapters/18/2/Making_Decisions"
                >
                  
                    18.2
                  
                  Making Decisions
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/choldgraf/jupyter-book">Jupyter Book</a></p>
</nav>

      <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
      <ul class="toc__menu">
  <li><a href="#the-regression-line">The Regression Line</a></li>
  <li><a href="#measuring-in-standard-units">Measuring in Standard Units</a></li>
  <li><a href="#identifying-the-line-in-standard-units">Identifying the Line in Standard Units</a></li>
  <li><a href="#the-regression-line-in-standard-units">The Regression Line, in Standard Units</a></li>
  <li><a href="#the-regression-effect">The Regression Effect</a></li>
  <li><a href="#the-equation-of-the-regression-line">The Equation of the Regression Line</a></li>
  <li><a href="#the-regression-line-and-galtons-data">The Regression Line and Galton’s Data</a></li>
  <li><a href="#fitted-values">Fitted Values</a></li>
  <li><a href="#units-of-measurement-of-the-slope">Units of Measurement of the Slope</a></li>
  <li><a href="#example">Example</a></li>
  <li><a href="#endnote">Endnote</a></li>
</ul>
    </nav>
  </aside>



      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            
<div class="buttons">








<a href="https://mybinder.org/v2/gh/olebo/dsf/gh-pages?filepath=content%2Fchapters%2F15%2F2%2FRegression_Line.ipynb"><button class="interact-button" id="interact-button-binder"><img class="interact-button-logo" src="/dsf/assets/images/logo_binder.svg" alt="Interact" />Interact</button></a>


</div>


            <div class="c-textbook__content">
              <h3 id="the-regression-line">The Regression Line</h3>
<p>The correlation coefficient $r$ doesn’t just measure how clustered the points in a scatter plot are about a straight line. It also helps identify the straight line about which the points are clustered. In this section we will retrace the path that Galton and Pearson took to discover that line.</p>

<p>Galton’s data on the heights of parents and their adult children showed a linear association. The linearity was confirmed when our predictions of the children’s heights based on the midparent heights roughly followed a straight line.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">galton</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">path_data</span> <span class="o">+</span> <span class="s">'galton.csv'</span><span class="p">)</span>

<span class="n">heights</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
    <span class="s">'MidParent'</span><span class="p">,</span> <span class="n">galton</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s">'midparentHeight'</span><span class="p">),</span>
    <span class="s">'Child'</span><span class="p">,</span> <span class="n">galton</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s">'childHeight'</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">predict_child</span><span class="p">(</span><span class="n">mpht</span><span class="p">):</span>
    <span class="s">"""Return a prediction of the height of a child 
    whose parents have a midparent height of mpht.
    
    The prediction is the average height of the children 
    whose midparent height is in the range mpht plus or minus 0.5 inches.
    """</span>
    
    <span class="n">close_points</span> <span class="o">=</span> <span class="n">heights</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s">'MidParent'</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">mpht</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">mpht</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">close_points</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s">'Child'</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>   
</code></pre></div></div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">heights_with_predictions</span> <span class="o">=</span> <span class="n">heights</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span>
    <span class="s">'Prediction'</span><span class="p">,</span> <span class="n">heights</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">predict_child</span><span class="p">,</span> <span class="s">'MidParent'</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">heights_with_predictions</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s">'MidParent'</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../../images/chapters/15/2/Regression_Line_5_0.png" alt="png" /></p>

<h3 id="measuring-in-standard-units">Measuring in Standard Units</h3>

<p>Let’s see if we can find a way to identify this line. First, notice that linear association doesn’t depend on the units of measurement – we might as well measure both variables in standard units.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">standard_units</span><span class="p">(</span><span class="n">xyz</span><span class="p">):</span>
    <span class="s">"Convert any array of numbers to standard units."</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">xyz</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xyz</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">xyz</span><span class="p">)</span>  
</code></pre></div></div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">heights_SU</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">with_columns</span><span class="p">(</span>
    <span class="s">'MidParent SU'</span><span class="p">,</span> <span class="n">standard_units</span><span class="p">(</span><span class="n">heights</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s">'MidParent'</span><span class="p">)),</span>
    <span class="s">'Child SU'</span><span class="p">,</span> <span class="n">standard_units</span><span class="p">(</span><span class="n">heights</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s">'Child'</span><span class="p">))</span>
<span class="p">)</span>
<span class="n">heights_SU</span>
</code></pre></div></div>

<div class="output output_html">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>MidParent SU</th> <th>Child SU</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>3.45465     </td> <td>1.80416  </td>
        </tr>
        <tr>
            <td>3.45465     </td> <td>0.686005 </td>
        </tr>
        <tr>
            <td>3.45465     </td> <td>0.630097 </td>
        </tr>
        <tr>
            <td>3.45465     </td> <td>0.630097 </td>
        </tr>
        <tr>
            <td>2.47209     </td> <td>1.88802  </td>
        </tr>
        <tr>
            <td>2.47209     </td> <td>1.60848  </td>
        </tr>
        <tr>
            <td>2.47209     </td> <td>-0.348285</td>
        </tr>
        <tr>
            <td>2.47209     </td> <td>-0.348285</td>
        </tr>
        <tr>
            <td>1.58389     </td> <td>1.18917  </td>
        </tr>
        <tr>
            <td>1.58389     </td> <td>0.350559 </td>
        </tr>
    </tbody>
</table>
<p>... (924 rows omitted)</p>
</div>

<p>On this scale, we can calculate our predictions exactly as before. But first we have to figure out how to convert our old definition of “close” points to a value on the new scale. We had said that midparent heights were “close” if they were within 0.5 inches of each other. Since standard units measure distances in units of SDs, we have to figure out how many SDs of midparent height correspond to 0.5 inches.</p>

<p>One SD of midparent heights is about 1.8 inches. So 0.5 inches is about 0.28 SDs.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sd_midparent</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">heights</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">sd_midparent</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.8014050969207571
</code></pre></div></div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">0.5</span><span class="o">/</span><span class="n">sd_midparent</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.277561110965367
</code></pre></div></div>

<p>We are now ready to modify our prediction function to make predictions on the standard units scale. All that has changed is that we are using the table of values in standard units, and defining “close” as above.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">predict_child_su</span><span class="p">(</span><span class="n">mpht_su</span><span class="p">):</span>
    <span class="s">"""Return a prediction of the height (in standard units) of a child 
    whose parents have a midparent height of mpht_su in standard units.
    """</span>
    <span class="n">close</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">/</span><span class="n">sd_midparent</span>
    <span class="n">close_points</span> <span class="o">=</span> <span class="n">heights_SU</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s">'MidParent SU'</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">between</span><span class="p">(</span><span class="n">mpht_su</span><span class="o">-</span><span class="n">close</span><span class="p">,</span> <span class="n">mpht_su</span> <span class="o">+</span> <span class="n">close</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">close_points</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s">'Child SU'</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>   
</code></pre></div></div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">heights_with_su_predictions</span> <span class="o">=</span> <span class="n">heights_SU</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span>
    <span class="s">'Prediction SU'</span><span class="p">,</span> <span class="n">heights_SU</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">predict_child_su</span><span class="p">,</span> <span class="s">'MidParent SU'</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">heights_with_su_predictions</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s">'MidParent SU'</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../../images/chapters/15/2/Regression_Line_15_0.png" alt="png" /></p>

<p>This plot looks exactly like the plot drawn on the original scale. Only the numbers on the axes have changed. This confirms that we can understand the prediction process by just working in standard units.</p>

<h3 id="identifying-the-line-in-standard-units">Identifying the Line in Standard Units</h3>
<p>Galton’s scatter plot has a <em>football</em> shape – that is, it is roughly oval like an American football. Not all scatter plots are football shaped, not even those that show linear association. But in this section we will pretend we are Galton and work only with football shaped scatter plots. In the next section, we will generalize our analysis to other shapes of plots.</p>

<p>Here is a football shaped scatter plot with both variables measured in standard units. The 45 degree line is shown in red.</p>

<p class="output output_png"><img src="../../../images/chapters/15/2/Regression_Line_18_0.png" alt="png" /></p>

<p>But the 45 degree line is not the line that picks off the centers of the vertical strips. You can see that in the figure below, where the vertical line at 1.5 standard units is shown in black. The points on the scatter plot near the black line all have heights roughly in the -2 to 3 range. The red line is too high to pick off the center.</p>

<p class="output output_png"><img src="../../../images/chapters/15/2/Regression_Line_20_0.png" alt="png" /></p>

<p>So the 45 degree line is not the “graph of averages.” That line is the green one shown below.</p>

<p class="output output_png"><img src="../../../images/chapters/15/2/Regression_Line_22_0.png" alt="png" /></p>

<p>Both lines go through the origin (0, 0). The green line goes through the centers of the vertical strips (at least roughly), and is <em>flatter</em> than the red 45 degree line.</p>

<p>The slope of the 45 degree line is 1. So the slope of the green “graph of averages” line is a value that is positive but less than 1.</p>

<p>What value could that be? You’ve guessed it – it’s $r$.</p>

<h3 id="the-regression-line-in-standard-units">The Regression Line, in Standard Units</h3>
<p>The green “graph of averages” line is called the <em>regression line</em>, for reasons we will explain shortly. But first, let’s simulate some football shaped scatter plots with different values of $r$, and see how the line changes. In each case, the red 45 degree line has been drawn for comparison.</p>

<p>The function that performs the simulation is called <code class="highlighter-rouge">regression_line</code> and takes $r$ as its argument.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">regression_line</span><span class="p">(</span><span class="mf">0.95</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../../images/chapters/15/2/Regression_Line_26_0.png" alt="png" /></p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">regression_line</span><span class="p">(</span><span class="mf">0.6</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../../images/chapters/15/2/Regression_Line_27_0.png" alt="png" /></p>

<p>When $r$ is close to 1, the scatter plot, the 45 degree line, and the regression line are all very close to each other. But for more moderate values of $r$, the regression line is noticeably flatter.</p>

<h3 id="the-regression-effect">The Regression Effect</h3>
<p>In terms of prediction, this means that for a parents whose midparent height is at 1.5 standard units, our prediction of the child’s height is somewhat <em>less</em> than 1.5 standard units. If the midparent height is 2 standard units, we predict that the child’s height will be somewhat less than 2 standard units.</p>

<p>In other words, we predict that the child will be somewhat closer to average than the parents were.</p>

<p>This didn’t please Sir Francis Galton. He had been hoping that exceptionally tall parents would have children who were just as exceptionally tall. However, the data were clear, and Galton realized that the tall parents have children who are not quite as exceptionally tall, on average. Frustrated, Galton called this phenomenon “regression to mediocrity.”</p>

<p>Galton also noticed that exceptionally short parents had children who were somewhat taller relative to their generation, on average. In general, individuals who are away from average on one variable are expected to be not quite as far away from average on the other. This is called the <em>regression effect</em>.</p>

<h3 id="the-equation-of-the-regression-line">The Equation of the Regression Line</h3>
<p>In regression, we use the value of one variable (which we will call $x$) to predict the value of another (which we will call $y$). When the variables $x$ and $y$ are measured in standard units, the regression line for predicting $y$ based on $x$ has slope $r$ and passes through the origin. Thus the equation of the regression line can be written as:</p>

<script type="math/tex; mode=display">\mbox{estimate of }y ~=~ r \cdot x ~~~
\mbox{when both variables are measured in standard units}</script>

<p>In the original units of the data, this becomes</p>

<script type="math/tex; mode=display">\frac{\mbox{estimate of}~y ~-~\mbox{average of}~y}{\mbox{SD of}~y}
~=~ r \times 
\frac{\mbox{the given}~x ~-~\mbox{average of}~x}{\mbox{SD of}~x}</script>

<p><img src="../../../images/regline.png" alt="regline" /></p>

<p>The slope and intercept of the regression line in original units can be derived from the diagram above.</p>

<script type="math/tex; mode=display">\mathbf{\mbox{slope of the regression line}} ~=~ r \cdot
\frac{\mbox{SD of }y}{\mbox{SD of }x}</script>

<script type="math/tex; mode=display">\mathbf{\mbox{intercept of the regression line}} ~=~
\mbox{average of }y ~-~ \mbox{slope} \cdot \mbox{average of }x</script>

<p>The three functions below compute the correlation, slope, and intercept. All of them take three arguments: the name of the table, the label of the column containing $x$, and the label of the column containing $y$.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">correlation</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label_x</span><span class="p">,</span> <span class="n">label_y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">standard_units</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">label_x</span><span class="p">))</span><span class="o">*</span><span class="n">standard_units</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">label_y</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">slope</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label_x</span><span class="p">,</span> <span class="n">label_y</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">correlation</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label_x</span><span class="p">,</span> <span class="n">label_y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">label_y</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">label_x</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">intercept</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label_x</span><span class="p">,</span> <span class="n">label_y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">label_y</span><span class="p">))</span> <span class="o">-</span> <span class="n">slope</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">label_x</span><span class="p">,</span> <span class="n">label_y</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">label_x</span><span class="p">))</span>
</code></pre></div></div>

<h3 id="the-regression-line-and-galtons-data">The Regression Line and Galton’s Data</h3>
<p>The correlation between midparent height and child’s height is 0.32:</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">galton_r</span> <span class="o">=</span> <span class="n">correlation</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="s">'MidParent'</span><span class="p">,</span> <span class="s">'Child'</span><span class="p">)</span>
<span class="n">galton_r</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.32094989606395924
</code></pre></div></div>

<p>We can also find the equation of the regression line for predicting the child’s height based on midparent height.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">galton_slope</span> <span class="o">=</span> <span class="n">slope</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="s">'MidParent'</span><span class="p">,</span> <span class="s">'Child'</span><span class="p">)</span>
<span class="n">galton_intercept</span> <span class="o">=</span> <span class="n">intercept</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="s">'MidParent'</span><span class="p">,</span> <span class="s">'Child'</span><span class="p">)</span>
<span class="n">galton_slope</span><span class="p">,</span> <span class="n">galton_intercept</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(0.637360896969479, 22.63624054958975)
</code></pre></div></div>

<p>The equation of the regression line is</p>

<script type="math/tex; mode=display">\mbox{estimate of child's height} ~=~ 0.64 \cdot \mbox{midparent height} ~+~ 22.64</script>

<p>This is also known as the <em>regression equation.</em> The principal use of the regression equation is to predict $y$ based on $x$.</p>

<p>For example, for a midparent height of 70.48 inches, the regression equation predicts the child’s height to be 67.56 inches.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">galton_slope</span><span class="o">*</span><span class="mf">70.48</span> <span class="o">+</span> <span class="n">galton_intercept</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>67.55743656799862
</code></pre></div></div>

<p>Our original prediction, created by taking the average height of all children who had midparent heights close to 70.48, came out to be pretty close: 67.63 inches compared to the regression line’s prediction of 67.55 inches.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">heights_with_predictions</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s">'MidParent'</span><span class="p">,</span> <span class="n">are</span><span class="o">.</span><span class="n">equal_to</span><span class="p">(</span><span class="mf">70.48</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div></div>

<div class="output output_html">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>MidParent</th> <th>Child</th> <th>Prediction</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>70.48    </td> <td>74   </td> <td>67.6342   </td>
        </tr>
        <tr>
            <td>70.48    </td> <td>70   </td> <td>67.6342   </td>
        </tr>
        <tr>
            <td>70.48    </td> <td>68   </td> <td>67.6342   </td>
        </tr>
    </tbody>
</table>
<p>... (5 rows omitted)</p>
</div>

<p>Here are all of the rows in Galton’s table, along with our original predictions and the new regression predictions of the children’s heights.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">heights_with_predictions</span> <span class="o">=</span> <span class="n">heights_with_predictions</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span>
    <span class="s">'Regression Prediction'</span><span class="p">,</span> <span class="n">galton_slope</span><span class="o">*</span><span class="n">heights</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s">'MidParent'</span><span class="p">)</span> <span class="o">+</span> <span class="n">galton_intercept</span>
<span class="p">)</span>
<span class="n">heights_with_predictions</span>
</code></pre></div></div>

<div class="output output_html">
<table border="1" class="dataframe">
    <thead>
        <tr>
            <th>MidParent</th> <th>Child</th> <th>Prediction</th> <th>Regression Prediction</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>75.43    </td> <td>73.2 </td> <td>70.1      </td> <td>70.7124              </td>
        </tr>
        <tr>
            <td>75.43    </td> <td>69.2 </td> <td>70.1      </td> <td>70.7124              </td>
        </tr>
        <tr>
            <td>75.43    </td> <td>69   </td> <td>70.1      </td> <td>70.7124              </td>
        </tr>
        <tr>
            <td>75.43    </td> <td>69   </td> <td>70.1      </td> <td>70.7124              </td>
        </tr>
        <tr>
            <td>73.66    </td> <td>73.5 </td> <td>70.4158   </td> <td>69.5842              </td>
        </tr>
        <tr>
            <td>73.66    </td> <td>72.5 </td> <td>70.4158   </td> <td>69.5842              </td>
        </tr>
        <tr>
            <td>73.66    </td> <td>65.5 </td> <td>70.4158   </td> <td>69.5842              </td>
        </tr>
        <tr>
            <td>73.66    </td> <td>65.5 </td> <td>70.4158   </td> <td>69.5842              </td>
        </tr>
        <tr>
            <td>72.06    </td> <td>71   </td> <td>68.5025   </td> <td>68.5645              </td>
        </tr>
        <tr>
            <td>72.06    </td> <td>68   </td> <td>68.5025   </td> <td>68.5645              </td>
        </tr>
    </tbody>
</table>
<p>... (924 rows omitted)</p>
</div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">heights_with_predictions</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s">'MidParent'</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../../images/chapters/15/2/Regression_Line_43_0.png" alt="png" /></p>

<p>The grey dots show the regression predictions, all on the regression line. Notice how the line is very close to the gold graph of averages. For these data, the regression line does a good job of approximating the centers of the vertical strips.</p>

<h3 id="fitted-values">Fitted Values</h3>
<p>The predictions all lie on the line and are known as the “fitted values”. The function <code class="highlighter-rouge">fit</code> takes the name of the table and the labels of $x$ and $y$, and returns an array of fitted values, one fitted value for each point in the scatter plot.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="s">"""Return the height of the regression line at each x value."""</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">slope</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">intercept</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">table</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>
</code></pre></div></div>

<p>It is easier to see the line in the graph below than in the one above.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">heights</span><span class="o">.</span><span class="n">with_column</span><span class="p">(</span><span class="s">'Fitted'</span><span class="p">,</span> <span class="n">fit</span><span class="p">(</span><span class="n">heights</span><span class="p">,</span> <span class="s">'MidParent'</span><span class="p">,</span> <span class="s">'Child'</span><span class="p">))</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s">'MidParent'</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../../images/chapters/15/2/Regression_Line_48_0.png" alt="png" /></p>

<p>Another way to draw the line is to use the option <code class="highlighter-rouge">fit_line=True</code> with the Table method <code class="highlighter-rouge">scatter</code>.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">heights</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s">'MidParent'</span><span class="p">,</span> <span class="n">fit_line</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../../images/chapters/15/2/Regression_Line_50_0.png" alt="png" /></p>

<h3 id="units-of-measurement-of-the-slope">Units of Measurement of the Slope</h3>
<p>The slope is a ratio, and it worth taking a moment to study the units in which it is measured. Our example comes from the familiar dataset about mothers who gave birth in a hospital system. The scatter plot of pregnancy weights versus heights looks like a football that has been used in one game too many, but it’s close enough to a football that we can justify putting our fitted line through it. In later sections we will see how to make such justifications more formal.</p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">baby</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">path_data</span> <span class="o">+</span> <span class="s">'baby.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">baby</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s">'Maternal Height'</span><span class="p">,</span> <span class="s">'Maternal Pregnancy Weight'</span><span class="p">,</span> <span class="n">fit_line</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p class="output output_png"><img src="../../../images/chapters/15/2/Regression_Line_53_0.png" alt="png" /></p>

<div class="language-python input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">slope</span><span class="p">(</span><span class="n">baby</span><span class="p">,</span> <span class="s">'Maternal Height'</span><span class="p">,</span> <span class="s">'Maternal Pregnancy Weight'</span><span class="p">)</span>
</code></pre></div></div>

<div class="output output_data_text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3.572846259275056
</code></pre></div></div>

<p>The slope of the regression line is <strong>3.57 pounds per inch</strong>. This means that for two women who are 1 inch apart in height, our prediction of pregnancy weight will differ by 3.57 pounds. For a woman who is 2 inches taller than another, our prediction of pregnancy weight will be 
<script type="math/tex">2 \times 3.57 ~=~ 7.14</script>
pounds more than our prediction for the shorter woman.</p>

<p>Notice that the successive vertical strips in the scatter plot are one inch apart, because the heights have been rounded to the nearest inch. Another way to think about the slope is to take any two consecutive strips (which are necessarily 1 inch apart), corresponding to two groups of women who are separated by 1 inch in height. The slope of 3.57 pounds per inch means that the average pregnancy weight of the taller group is about 3.57 pounds more than that of the shorter group.</p>

<h3 id="example">Example</h3>

<p>Suppose that our goal is to use regression to estimate the height of a basset hound based on its weight, using a sample that looks consistent with the regression model. Suppose the observed correlation $r$ is 0.5, and that the summary statistics for the two variables are as in the table below:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right"> </th>
      <th style="text-align: center"><strong>average</strong></th>
      <th style="text-align: center"><strong>SD</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">height</td>
      <td style="text-align: center">14 inches</td>
      <td style="text-align: center">2 inches</td>
    </tr>
    <tr>
      <td style="text-align: right">weight</td>
      <td style="text-align: center">50 pounds</td>
      <td style="text-align: center">5 pounds</td>
    </tr>
  </tbody>
</table>

<p>To calculate the equation of the regression line, we need the slope and the intercept.</p>

<script type="math/tex; mode=display">\mbox{slope} ~=~ \frac{r \cdot \mbox{SD of }y}{\mbox{SD of }x} ~=~
\frac{0.5 \cdot 2 \mbox{ inches}}{5 \mbox{ pounds}} ~=~ 0.2 ~\mbox{inches per pound}</script>

<script type="math/tex; mode=display">\mbox{intercept} ~=~ \mbox{average of }y - \mbox{slope}\cdot \mbox{average of } x
~=~ 14 \mbox{ inches} ~-~ 0.2 \mbox{ inches per pound} \cdot 50 \mbox{ pounds}
~=~ 4 \mbox{ inches}</script>

<p>The equation of the regression line allows us to calculate the estimated height, in inches,
based on a given weight in pounds:</p>

<script type="math/tex; mode=display">\mbox{estimated height} ~=~ 0.2 \cdot \mbox{given weight} ~+~ 4</script>

<p>The slope of the line is measures the increase in the estimated height per unit increase in weight. The slope is positive, and it is important to note that this does not mean that we think basset hounds get taller if they put on weight. The slope reflects the difference in the average heights of two groups of dogs that are 1 pound apart in weight. Specifically, consider a group of dogs whose weight is $w$ pounds, and the group whose weight is $w+1$ pounds. The second group is estimated to be 0.2 inches taller, on average. This is true for all values of $w$ in the sample.</p>

<p>In general, the slope of the regression line can be interpreted as the average increase in $y$ per unit increase in $x$. Note that if the slope is negative, then for every unit increase in $x$, the average of $y$ decreases.</p>

<h3 id="endnote">Endnote</h3>
<p>Even though we won’t establish the mathematical basis for the regression equation, we can see that it gives pretty good predictions when the scatter plot is football shaped. It is a surprising mathematical fact that no matter what the shape of the scatter plot, the same equation gives the “best” among all straight lines. That’s the topic of the next section.</p>

              <nav class="c-page__nav">
  
    
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/dsf/chapters/15/1/Correlation">
      〈 <span class="u-margin-right-tiny"></span> Correlation
    </a>
  

  
    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/dsf/chapters/15/3/Method_of_Least_Squares">
      The Method of Least Squares <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
